<?xml version="1.0" encoding="UTF-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:MauiAppTCC2.ViewModels"
             x:Class="MauiAppTCC2.MainPage"
             Title="Meus Pets"
             BackgroundColor="#F8F9FA">

    <ContentPage.BindingContext>
        <viewmodels:PetViewModel />
    </ContentPage.BindingContext>

    <ScrollView>
        <VerticalStackLayout Spacing="25" Padding="20" VerticalOptions="Start">

            <!-- 🐾 CABEÇALHO -->
            <Frame BackgroundColor="#512BD4" 
                   Padding="20,15"
                   CornerRadius="15"
                   HorizontalOptions="Fill"
                   HasShadow="True">
                <VerticalStackLayout Spacing="8">
                    <Label Text="🐾 PetVaccine" 
                           FontSize="28" 
                           HorizontalOptions="Center" 
                           FontAttributes="Bold"
                           TextColor="White"/>

                    <Label Text="Sistema de controle de vacinas para pets" 
                           FontSize="16" 
                           HorizontalOptions="Center"
                           TextColor="#E0E0E0"/>
                </VerticalStackLayout>
            </Frame>

            <!-- ➕ BOTÃO ADICIONAR PET -->
            <Button Text="➕ Adicionar Novo Pet" 
                    Command="{Binding AddPetCommand}"
                    BackgroundColor="#2196F3"
                    TextColor="White"
                    FontSize="16"
                    FontAttributes="Bold"
                    HeightRequest="55"
                    CornerRadius="12"
                    HorizontalOptions="Fill"
                    Margin="0,10,0,0"/>

            <!-- 📊 ESTATÍSTICAS -->
            <Frame BackgroundColor="White" 
                   Padding="15"
                   CornerRadius="12"
                   HasShadow="True"
                   BorderColor="#E0E0E0">
                <HorizontalStackLayout Spacing="15" HorizontalOptions="Center">
                    <Frame BackgroundColor="#E3F2FD" Padding="12,8" CornerRadius="8">
                        <Label Text="{Binding Pets.Count}" 
                               FontSize="20" 
                               FontAttributes="Bold"
                               TextColor="#1976D2"
                               HorizontalOptions="Center"/>
                    </Frame>
                    <VerticalStackLayout VerticalOptions="Center">
                        <Label Text="Pets Cadastrados" 
                               FontSize="14" 
                               TextColor="#666"/>
                        <Label Text="Total de animais" 
                               FontSize="12" 
                               TextColor="#999"/>
                    </VerticalStackLayout>
                </HorizontalStackLayout>
            </Frame>

            <!-- 🐕 LISTA DE PETS -->
            <Frame BackgroundColor="White" 
                   Padding="0"
                   CornerRadius="15"
                   HasShadow="True"
                   BorderColor="#E0E0E0">
                <VerticalStackLayout Spacing="0">
                    <!-- CABEÇALHO DA LISTA -->
                    <Frame BackgroundColor="#F5F5F5" 
                           Padding="15,12"
                           CornerRadius="15">
                        <Label Text="Meus Pets" 
                               FontSize="18" 
                               FontAttributes="Bold"
                               TextColor="#333"/>
                    </Frame>

                    <!-- LISTA -->
                    <CollectionView ItemsSource="{Binding Pets}"
                                  SelectionMode="Single"
                                  SelectedItem="{Binding SelectedPet}">

                        <CollectionView.EmptyView>
                            <VerticalStackLayout HorizontalOptions="Center" 
                                               VerticalOptions="Center"
                                               Padding="40"
                                               Spacing="15">
                                <Label Text="🐾" 
                                       FontSize="40" 
                                       HorizontalOptions="Center"/>
                                <Label Text="Nenhum pet cadastrado" 
                                       FontSize="16" 
                                       FontAttributes="Bold"
                                       HorizontalOptions="Center"
                                       TextColor="#666"/>
                                <Label Text="Toque no botão acima para adicionar seu primeiro pet!" 
                                       FontSize="14" 
                                       HorizontalOptions="Center"
                                       TextColor="#999"
                                       HorizontalTextAlignment="Center"/>
                            </VerticalStackLayout>
                        </CollectionView.EmptyView>

                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <Frame Padding="15" 
                                       Margin="10,5,10,5" 
                                       BackgroundColor="#FFFFFF"
                                       BorderColor="#E0E0E0"
                                       CornerRadius="12"
                                       HasShadow="True">

                                    <Grid ColumnDefinitions="Auto,*,Auto" 
                                          RowDefinitions="Auto,Auto"
                                          RowSpacing="5"
                                          ColumnSpacing="15">

                                        <!-- ÍCONE DO PET -->
                                        <Frame Grid.RowSpan="2" 
                                               Grid.Column="0"
                                               WidthRequest="50"
                                               HeightRequest="50"
                                               Padding="0"
                                               CornerRadius="25"
                                               BackgroundColor="#E3F2FD"
                                               HorizontalOptions="Center"
                                               VerticalOptions="Center">
                                            <Label Text="🐕" 
                                                   FontSize="20"
                                                   HorizontalOptions="Center"
                                                   VerticalOptions="Center"/>
                                        </Frame>

                                        <!-- INFORMAÇÕES DO PET -->
                                        <VerticalStackLayout Grid.Column="1" 
                                                           Grid.Row="0"
                                                           VerticalOptions="Center">
                                            <Label Text="{Binding Nome}" 
                                                   FontSize="16" 
                                                   FontAttributes="Bold"
                                                   TextColor="#333"/>
                                            <Label Text="{Binding Especie}" 
                                                   FontSize="14"
                                                   TextColor="#666"/>
                                        </VerticalStackLayout>

                                        <VerticalStackLayout Grid.Column="1" 
                                                           Grid.Row="1">
                                            <Label Text="{Binding Raca}" 
                                                   FontSize="12" 
                                                   TextColor="#888"/>
                                            <Label Text="{Binding Idade, StringFormat='{0} anos'}" 
                                                   FontSize="12" 
                                                   TextColor="#2196F3"
                                                   FontAttributes="Bold"/>
                                        </VerticalStackLayout>

                                        <!-- BOTÃO VACINAS -->
                                        <Button Grid.Column="2"
                                              Grid.RowSpan="2"
                                              Text="💉"
                                              FontSize="14"
                                              BackgroundColor="#4CAF50"
                                              TextColor="White"
                                              WidthRequest="45"
                                              HeightRequest="45"
                                              CornerRadius="22"
                                              Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:PetViewModel}}, Path=ShowVacinasCommand}"
                                              CommandParameter="{Binding Id}"/>

                                    </Grid>
                                </Frame>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                </VerticalStackLayout>
            </Frame>

            <!-- 🔄 BOTÃO ATUALIZAR -->
            <Button Text="🔄 Atualizar Lista" 
                    Command="{Binding RefreshCommand}"
                    BackgroundColor="Transparent"
                    TextColor="#666"
                    BorderColor="#666"
                    BorderWidth="1"
                    HeightRequest="45"
                    CornerRadius="10"
                    HorizontalOptions="Center"
                    FontSize="14"/>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>